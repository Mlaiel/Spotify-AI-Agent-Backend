# Enterprise Security Alert Template (English) - Advanced Industrial Grade
{% set security_icons = {
    'intrusion': 'ğŸ›¡ï¸',
    'authentication': 'ğŸ”',
    'authorization': 'ğŸ‘®',
    'data_breach': 'ğŸ’€',
    'malware': 'ğŸ¦ ',
    'ddos': 'âš¡',
    'vulnerability': 'ğŸ”',
    'compliance': 'ğŸ“‹',
    'audit': 'ğŸ”',
    'encryption': 'ğŸ”’'
} %}

ğŸ”´ **SECURITY ALERT** ğŸ”´

**{{ security_icons.get(alert.security_context.threat_type, 'ğŸ›¡ï¸') }} Security Incident Detection**
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ **Security Context**
â€¢ **Alert Type**: `{{ alert.security_context.threat_type | title }}`
â€¢ **Severity**: `{{ alert.severity.upper() }}` (Risk Score: {{ alert.security_context.risk_score | default(0) }}/10)
â€¢ **Classification**: `{{ alert.security_context.classification | title }}`
â€¢ **Environment**: `{{ environment | upper }}`
â€¢ **Service**: `{{ alert.context.service_name }}`

ğŸš¨ **Threat Details**
â€¢ **Incident**: {{ alert.title }}
â€¢ **Description**: {{ alert.description }}
â€¢ **Detected**: {{ format_date(alert.created_at) }}
â€¢ **Source**: {{ alert.security_context.source_ip | default('Unknown') }}
â€¢ **Target**: {{ alert.security_context.target_resource }}

{% if alert.security_context.attack_vector %}
ğŸ¯ **Attack Vector Analysis**
â€¢ **Vector Type**: {{ alert.security_context.attack_vector.type }}
â€¢ **Method**: {{ alert.security_context.attack_vector.method }}
â€¢ **Payload Size**: {{ alert.security_context.attack_vector.payload_size | default('N/A') }}
â€¢ **Frequency**: {{ alert.security_context.attack_vector.frequency }}
â€¢ **Pattern**: {{ alert.security_context.attack_vector.pattern | default('Unknown') }}
{% endif %}

{% if alert.security_context.geolocation %}
ğŸŒ **Geolocation Intelligence**
â€¢ **Source Country**: {{ alert.security_context.geolocation.country }} {{ alert.security_context.geolocation.flag | default('') }}
â€¢ **City**: {{ alert.security_context.geolocation.city }}
â€¢ **ISP**: {{ alert.security_context.geolocation.isp }}
â€¢ **Threat Intel**: {{ alert.security_context.geolocation.threat_score }}/10 risk
â€¢ **Known Bad Actor**: {{ alert.security_context.geolocation.is_known_bad | ternary('âŒ YES', 'âœ… No') }}
{% endif %}

{% if alert.security_context.user_context %}
ğŸ‘¤ **User Context**
â€¢ **User ID**: `{{ alert.security_context.user_context.user_id | default('Anonymous') }}`
â€¢ **Session ID**: `{{ alert.security_context.user_context.session_id }}`
â€¢ **User Agent**: {{ alert.security_context.user_context.user_agent | truncate(50) }}
â€¢ **Account Status**: {{ alert.security_context.user_context.account_status }}
â€¢ **Previous Violations**: {{ alert.security_context.user_context.violation_count | default(0) }}
{% endif %}

{% if alert.security_context.compliance_impact %}
ğŸ“‹ **Compliance Impact Assessment**
â€¢ **Affected Regulations**: {{ alert.security_context.compliance_impact.regulations | join(', ') }}
â€¢ **Data Classification**: {{ alert.security_context.compliance_impact.data_classification }}
â€¢ **Breach Notification Required**: {{ alert.security_context.compliance_impact.notification_required | ternary('âŒ YES', 'âœ… No') }}
â€¢ **Regulatory Risk**: {{ alert.security_context.compliance_impact.regulatory_risk_level }}
{% endif %}

{% if alert.ai_insights %}
ğŸ§  **AI Security Analysis**
{% if alert.ai_insights.threat_classification %}
**ğŸ” Threat Classification**: {{ alert.ai_insights.threat_classification.type }} ({{ alert.ai_insights.threat_classification.confidence }}% confidence)
{% endif %}

{% if alert.ai_insights.attack_prediction %}
**ğŸ”® Attack Prediction**: {{ alert.ai_insights.attack_prediction.escalation_probability }}% chance of escalation
**â° Estimated Impact Window**: {{ alert.ai_insights.attack_prediction.impact_window }}
{% endif %}

{% if alert.ai_insights.recommended_actions %}
**ğŸ›¡ï¸ Immediate Security Actions**:
{% for action in alert.ai_insights.recommended_actions[:4] %}
{{ loop.index }}. {{ action }}
{% endfor %}
{% endif %}

{% if alert.ai_insights.similar_attacks %}
**ğŸ“Š Attack Pattern Match**: {{ alert.ai_insights.similar_attacks.count }} similar incidents
**ğŸ¯ Success Rate**: {{ alert.ai_insights.similar_attacks.success_rate }}% of similar attacks blocked
{% endif %}
{% endif %}

{% if alert.security_context.affected_resources %}
ğŸ¯ **Affected Resources**
{% for resource in alert.security_context.affected_resources %}
â€¢ **{{ resource.type | title }}**: `{{ resource.identifier }}` ({{ resource.impact_level }})
{% endfor %}
{% endif %}

{% if alert.security_context.forensics %}
ğŸ”¬ **Forensics Data Available**
â€¢ **Logs Captured**: {{ alert.security_context.forensics.logs_size }}
â€¢ **Network Packets**: {{ alert.security_context.forensics.packet_count }}
â€¢ **File Hashes**: {{ alert.security_context.forensics.file_hashes | length }} files
â€¢ **Memory Dump**: {{ alert.security_context.forensics.memory_dump_available | ternary('âœ… Available', 'âŒ Not captured') }}
{% endif %}

ğŸš€ **Security Response Actions**
â€¢ [ğŸ›¡ï¸ Security Dashboard]({{ dashboard_url }}/security/incidents/{{ alert.alert_id }})
â€¢ [ğŸ” Threat Intelligence]({{ threat_intel_url }}/ip/{{ alert.security_context.source_ip }})
â€¢ [ğŸ“Š Attack Timeline]({{ dashboard_url }}/security/timeline/{{ alert.alert_id }})
â€¢ [ğŸ”¬ Forensics Viewer]({{ forensics_url }}/incident/{{ alert.alert_id }})
â€¢ [ğŸ“‹ Incident Response]({{ dashboard_url }}/security/response/{{ alert.alert_id }})
{% if alert.security_context.siem_case_id %}
â€¢ [ğŸ” SIEM Case]({{ siem_url }}/cases/{{ alert.security_context.siem_case_id }})
{% endif %}

{% if alert.auto_response %}
ğŸ¤– **Automated Response Status**
â€¢ **Auto-Block**: {{ alert.auto_response.auto_block_enabled | ternary('âœ… ACTIVE', 'âŒ Disabled') }}
â€¢ **Quarantine**: {{ alert.auto_response.quarantine_status | default('Not applicable') }}
â€¢ **Traffic Filtering**: {{ alert.auto_response.traffic_filtering | default('Normal') }}
â€¢ **Account Actions**: {{ alert.auto_response.account_actions | default('None taken') }}
{% endif %}

âš¡ **Escalation & Response Team**
â€¢ **Security Team**: @security-team
â€¢ **SOC Analyst**: @{{ alert.security_context.assigned_analyst | default('on-call-soc') }}
â€¢ **Incident Commander**: @{{ alert.security_context.incident_commander | default('security-lead') }}
â€¢ **Response Time**: {{ alert.security_context.target_response_time | default('15 minutes') }}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
**Security Alert ID**: `{{ alert.alert_id }}`
**Incident ID**: `{{ alert.security_context.incident_id }}`
**SIEM Rule**: `{{ alert.security_context.siem_rule_id | default('N/A') }}`
**Threat Level**: `{{ alert.security_context.threat_level | upper }}`

*ğŸ›¡ï¸ Spotify AI Agent Security Operations Center*
*Alert Generated: {{ format_date(now, 'iso') }}*
*Classification: {{ alert.security_context.classification | upper }}*
*âš ï¸ This is a SECURITY INCIDENT - Follow incident response procedures*
