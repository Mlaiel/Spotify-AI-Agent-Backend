# Template d'Alerte Critique Entreprise (FranÃ§ais) - Grade Industriel AvancÃ©
{% set alert_emoji = {
    'critical': 'ğŸš¨',
    'high': 'âš ï¸',
    'medium': 'ğŸ”¶',
    'low': 'ğŸ’¡',
    'info': 'â„¹ï¸'
} %}

{% set service_icons = {
    'api': 'ğŸŒ',
    'database': 'ğŸ—„ï¸',
    'ml': 'ğŸ¤–',
    'audio': 'ğŸµ',
    'auth': 'ğŸ”',
    'storage': 'ğŸ’¾',
    'cache': 'âš¡',
    'queue': 'ğŸ“¬',
    'monitoring': 'ğŸ“Š'
} %}

{{ alert_emoji.get(alert.severity, 'ğŸš¨') }} **ALERTE PRODUCTION CRITIQUE** {{ alert_emoji.get(alert.severity, 'ğŸš¨') }}

**{{ service_icons.get(alert.context.service_type, 'âš™ï¸') }} Analyse d'Impact Service**
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ **DÃ©tails Principaux**
â€¢ **Service**: `{{ alert.context.service_name }}` ({{ alert.context.service_version | default('inconnu') }})
â€¢ **Composant**: `{{ alert.context.component }}`
â€¢ **Environnement**: `{{ environment | upper }}` 
â€¢ **RÃ©gion**: `{{ alert.context.region | default('global') }}`
â€¢ **Cluster**: `{{ alert.context.cluster_name | default('dÃ©faut') }}`

ğŸ”¥ **Informations d'Alerte**
â€¢ **Titre**: {{ alert.title }}
â€¢ **Description**: {{ alert.description }}
â€¢ **SÃ©vÃ©ritÃ©**: `{{ alert.severity.upper() }}` ({{ alert.priority_score | default(0) }}/10)
â€¢ **Statut**: {{ alert.status | title }}
â€¢ **DÃ©clenchÃ©e**: {{ format_date(alert.created_at, 'full') }}
â€¢ **DurÃ©e**: {{ alert.duration | duration_format | default('Ã€ l'instant') }}

{% if alert.context.instance_id %}
ğŸ–¥ï¸ **Contexte Infrastructure**
â€¢ **Instance**: `{{ alert.context.instance_id }}`
â€¢ **NÅ“ud**: `{{ alert.context.node_name | default('N/A') }}`
â€¢ **Pod**: `{{ alert.context.pod_name | default('N/A') }}`
â€¢ **Namespace**: `{{ alert.context.namespace | default('dÃ©faut') }}`
{% endif %}

{% if alert.metrics %}
ğŸ“Š **MÃ©triques de Performance**
{% for metric_name, metric_value in alert.metrics.items() %}
â€¢ **{{ metric_name | title }}**: {{ metric_value }}
{% endfor %}
{% endif %}

{% if alert.business_impact %}
ğŸ’¼ **Ã‰valuation Impact Business**
â€¢ **Niveau d'Impact**: {{ alert.business_impact.level | title }}
â€¢ **Utilisateurs AffectÃ©s**: {{ alert.business_impact.affected_users | default('Inconnu') }}
â€¢ **Impact Revenus**: {{ alert.business_impact.estimated_cost | default('En Ã©valuation') }}
â€¢ **Statut SLA**: {{ alert.business_impact.sla_breach | ternary('âš ï¸ VIOLATION', 'âœ… OK') }}
{% endif %}

{% if alert.ai_insights %}
ğŸ¤– **Analyse et Recommandations IA**
{% if alert.ai_insights.root_cause_analysis %}
**ğŸ” Analyse Cause Racine**:
{{ alert.ai_insights.root_cause_analysis | truncate(200) }}
{% endif %}

{% if alert.ai_insights.recommended_actions %}
**ğŸ› ï¸ Actions ImmÃ©diates** (Auto-gÃ©nÃ©rÃ©es):
{% for action in alert.ai_insights.recommended_actions[:5] %}
{{ loop.index }}. {{ action }}
{% endfor %}
{% endif %}

{% if alert.ai_insights.similar_incidents %}
**ğŸ“ˆ Pattern Historique**: {{ alert.ai_insights.similar_incidents.count }} incidents similaires sur 30 jours
**â±ï¸ Temps RÃ©solution Moyen**: {{ alert.ai_insights.similar_incidents.avg_resolution_time | duration_format }}
{% endif %}

{% if alert.ai_insights.confidence_score %}
**ğŸ¯ Confiance IA**: {{ alert.ai_insights.confidence_score }}% de prÃ©cision
{% endif %}
{% endif %}

{% if alert.runbooks %}
ğŸ“š **Guides d'Urgence**
{% for runbook in alert.runbooks %}
â€¢ [{{ runbook.name }}]({{ runbook.url }}) - {{ runbook.description }}
{% endfor %}
{% endif %}

{% if alert.related_alerts %}
ğŸ”— **Alertes LiÃ©es Actives** ({{ alert.related_alerts | length }})
{% for related in alert.related_alerts[:3] %}
â€¢ {{ related.service }} - {{ related.title }} ({{ related.severity }})
{% endfor %}
{% if alert.related_alerts | length > 3 %}
â€¢ ... et {{ alert.related_alerts | length - 3 }} de plus
{% endif %}
{% endif %}

ğŸš€ **Actions Rapides**
{% set base_url = dashboard_url %}
â€¢ [ğŸ›ï¸ Tableau de Bord]({{ base_url }}/alerts/{{ alert.alert_id }})
â€¢ [ğŸ“Š MÃ©triques & Graphiques]({{ metrics_url }}/d/{{ alert.context.service_name }})
â€¢ [ğŸ“‹ Logs Service]({{ logs_url }}/app/{{ alert.context.service_name }})
â€¢ [ğŸ”§ Vue Infrastructure]({{ base_url }}/infrastructure/{{ alert.context.cluster_name }})
{% if alert.context.trace_id %}
â€¢ [ğŸ” TraÃ§age DistribuÃ©]({{ tracing_url }}/trace/{{ alert.context.trace_id }})
{% endif %}

{% if alert.escalation %}
âš¡ **Politique d'Escalade**
â€¢ **Astreinte**: @{{ alert.escalation.primary_oncall | default('chef-Ã©quipe') }}
â€¢ **Backup**: @{{ alert.escalation.secondary_oncall | default('Ã©quipe-backup') }}
â€¢ **Auto-escalade dans**: {{ alert.escalation.escalation_time | default('15 minutes') }}
{% endif %}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
**ID Alerte**: `{{ alert.alert_id }}`
**ID CorrÃ©lation**: `{{ alert.correlation_id | default('N/A') }}`
**Tenant**: `{{ alert.tenant_id | default('systÃ¨me') }}`

*ğŸµ SystÃ¨me de Monitoring Spotify AI Agent*
*GÃ©nÃ©rÃ©: {{ format_date(now, 'iso') }}*
*Environnement: {{ environment | upper }} | Version: {{ system_version | default('latest') }}*
