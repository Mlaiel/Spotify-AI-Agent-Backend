# üéµ Agent IA Spotify - Module Spleeter Avanc√©

[![Grade Entreprise](https://img.shields.io/badge/Entreprise-Grade-gold.svg)](https://github.com/spotify-ai-agent)
[![Python 3.8+](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://python.org)
[![TensorFlow](https://img.shields.io/badge/TensorFlow-2.x-orange.svg)](https://tensorflow.org)
[![Licence](https://img.shields.io/badge/Licence-MIT-green.svg)](LICENSE)

## üöÄ Aper√ßu

**Module Spleeter Avanc√© Entreprise** - Moteur de s√©paration audio de niveau industriel con√ßu pour des performances √©lev√©es et une s√©paration de sources musicales √©volutive. Ce module fournit des capacit√©s de traitement audio aliment√©es par IA de pointe avec des fonctionnalit√©s entreprise incluant le cache multi-niveaux, l'optimisation GPU, le traitement par lots et une surveillance compl√®te.

**üéñÔ∏è Architecte & D√©veloppeur Principal :** [Fahed Mlaiel](https://github.com/fahed-mlaiel)  
**üè¢ Organisation :** √âquipe Enterprise AI Solutions

---

## ‚ú® Fonctionnalit√©s Cl√©s

### üéØ **Capacit√©s Principales**
- **ü§ñ Mod√®les IA Avanc√©s** : Support pour s√©paration 2-stems, 4-stems et 5-stems
- **‚ö° Acc√©l√©ration GPU** : Traitement GPU CUDA/TensorFlow optimis√©
- **üîÑ Traitement Asynchrone** : Op√©rations non-bloquantes avec asyncio
- **üì¶ Op√©rations par Lots** : Traitement parall√®le haute performance
- **üéõÔ∏è Pr√©traitement Audio** : Filtrage avanc√©, normalisation, r√©duction de bruit

### üèóÔ∏è **Architecture Entreprise**
- **üíæ Cache Multi-Niveaux** : M√©moire (L1) ‚Üí Disque+SQLite (L2) ‚Üí Redis (L3)
- **üìä Surveillance Performance** : M√©triques temps r√©el, v√©rifications sant√©, alertes
- **üîß Gestion Mod√®les** : T√©l√©chargement automatique, validation, versioning
- **üõ°Ô∏è S√©curit√© & Validation** : Sanitisation des entr√©es, limites ressources, gestion erreurs
- **üìà √âvolutivit√©** : Pr√™t microservices, support mise √† l'√©chelle horizontale

### üéµ **Excellence Traitement Audio**
- **üìª Support Formats** : WAV, FLAC, MP3, OGG, M4A, AAC, WMA
- **üîä Options Qualit√©** : Traitement jusqu'√† 192kHz/32-bit
- **üéöÔ∏è Traitement Dynamique** : Normalisation volume, d√©tection silences
- **üìã Extraction M√©tadonn√©es** : Analyse audio compl√®te et √©tiquetage

---

## üõ†Ô∏è Installation

### Pr√©requis
```bash
# Python 3.8+ requis
python --version  # Devrait √™tre 3.8+

# Installer d√©pendances principales
pip install tensorflow>=2.8.0
pip install librosa>=0.9.0
pip install soundfile>=0.10.0
pip install numpy>=1.21.0
pip install asyncio-mqtt
pip install aioredis
```

### Configuration Rapide
```bash
# Cloner le d√©p√¥t
git clone https://github.com/spotify-ai-agent/backend.git
cd backend/spleeter

# Installer d√©pendances
pip install -r requirements.txt

# Initialiser le module
python -c "from spleeter import SpleeterEngine; print('‚úÖ Installation r√©ussie!')"
```

---

## üöÄ D√©marrage Rapide

### Utilisation Basique
```python
import asyncio
from spleeter import SpleeterEngine

async def separer_audio():
    # Initialiser moteur
    engine = SpleeterEngine()
    await engine.initialize()
    
    # S√©parer audio
    result = await engine.separate(
        audio_path="chanson.wav",
        model_name="spleeter:2stems-16kHz",
        output_dir="sortie/"
    )
    
    print(f"‚úÖ S√©paration termin√©e : {result.output_files}")

# Ex√©cuter
asyncio.run(separer_audio())
```

### Configuration Avanc√©e
```python
from spleeter import SpleeterEngine, SpleeterConfig

# Configuration entreprise
config = SpleeterConfig(
    # Performance
    enable_gpu=True,
    batch_size=8,
    worker_threads=4,
    
    # Cache
    cache_enabled=True,
    cache_size_mb=2048,
    redis_url="redis://localhost:6379",
    
    # Param√®tres audio
    default_sample_rate=44100,
    enable_preprocessing=True,
    normalize_loudness=True,
    
    # Surveillance
    enable_monitoring=True,
    metrics_export_interval=60
)

engine = SpleeterEngine(config=config)
```

---

## üìö R√©f√©rence API

### SpleeterEngine
Moteur de traitement principal avec capacit√©s entreprise.

#### M√©thodes

**`async initialize()`**
Initialise le moteur et charge les mod√®les.

**`async separate(audio_path, model_name, output_dir, **options)`**
S√©pare l'audio en stems.
- `audio_path` : Chemin fichier audio d'entr√©e
- `model_name` : Identifiant mod√®le (ex : "spleeter:2stems-16kHz")
- `output_dir` : R√©pertoire sortie pour stems s√©par√©s
- `options` : Options traitement additionnelles

**`async batch_separate(audio_files, **options)`**
Traite plusieurs fichiers en parall√®le.

**`get_available_models()`**
Liste tous les mod√®les de s√©paration disponibles.

**`get_processing_stats()`**
R√©cup√®re statistiques de performance.

### ModelManager
Syst√®me de gestion avanc√©e des mod√®les.

#### M√©thodes

**`async download_model(model_name, force=False)`**
T√©l√©charge et met en cache un mod√®le sp√©cifique.

**`list_local_models()`**
Liste les mod√®les disponibles localement.

**`validate_model(model_name)`**
V√©rifie l'int√©grit√© du mod√®le.

### CacheManager
Syst√®me de cache multi-niveaux.

#### M√©thodes

**`async get(key, cache_level="auto")`**
R√©cup√®re donn√©es en cache.

**`async set(key, data, ttl=3600, cache_level="auto")`**
Stocke donn√©es dans le cache.

**`get_cache_stats()`**
Statistiques performance du cache.

---

## üîß Configuration

### Variables d'Environnement
```bash
# Configuration GPU
SPLEETER_ENABLE_GPU=true
SPLEETER_GPU_MEMORY_GROWTH=true

# Configuration Cache
SPLEETER_CACHE_DIR=/var/cache/spleeter
SPLEETER_REDIS_URL=redis://localhost:6379/0

# Configuration Mod√®les
SPLEETER_MODELS_DIR=/opt/spleeter/models
SPLEETER_AUTO_DOWNLOAD=true

# Surveillance
SPLEETER_ENABLE_MONITORING=true
SPLEETER_METRICS_PORT=9090
```

### Fichier Configuration (config.yaml)
```yaml
spleeter:
  performance:
    enable_gpu: true
    batch_size: 8
    worker_threads: 4
    memory_limit_mb: 8192
  
  cache:
    enabled: true
    memory_size_mb: 512
    disk_size_mb: 2048
    redis_url: "redis://localhost:6379/0"
    ttl_hours: 24
  
  audio:
    default_sample_rate: 44100
    supported_formats: ["wav", "flac", "mp3", "ogg"]
    enable_preprocessing: true
    normalize_loudness: true
    
  monitoring:
    enabled: true
    export_interval: 60
    health_check_interval: 30
    alert_thresholds:
      memory_usage: 85
      gpu_usage: 90
      error_rate: 5
```

---

## üìä Performance & Surveillance

### M√©triques Temps R√©el
Le module fournit des capacit√©s de surveillance compl√®tes :

- **üéØ M√©triques Traitement** : Taux de succ√®s, temps de traitement, d√©bit
- **üíæ Utilisation Ressources** : CPU, m√©moire, utilisation GPU
- **üîÑ Performance Cache** : Taux de r√©ussite, efficacit√© cache
- **üö® Surveillance Sant√©** : √âtat syst√®me, suivi erreurs, alertes

### Tableau de Bord Surveillance
```python
from spleeter.monitoring import get_stats_summary

# Obtenir statistiques compl√®tes
stats = get_stats_summary()
print(f"Taux de Succ√®s : {stats['processing_stats']['success_rate']}%")
print(f"Taux R√©ussite Cache : {stats['processing_stats']['cache_hit_rate']}%")
print(f"Sant√© Syst√®me : {stats['system_health']['status']}")
```

### Conseils Optimisation Performance

1. **üéØ Utilisation GPU** : Activer acc√©l√©ration GPU pour am√©lioration vitesse 2-3x
2. **üíæ Cache** : Configurer tailles cache appropri√©es pour votre charge
3. **üì¶ Traitement Lots** : Utiliser op√©rations par lots pour plusieurs fichiers
4. **üîß S√©lection Mod√®le** : Choisir complexit√© mod√®le appropri√©e vs vitesse
5. **‚ö° Pr√©traitement** : Activer pr√©traitement pour meilleure qualit√© s√©paration

---

## üõ°Ô∏è S√©curit√© & Bonnes Pratiques

### Validation Entr√©es
- **Validation Format Fichier** : D√©tection et validation automatique format
- **Limites Taille** : Limites configurables taille fichier et dur√©e
- **S√©curit√© Chemins** : Protection contre attaques travers√©e chemins
- **Limites Ressources** : Contraintes m√©moire et temps traitement

### Gestion Erreurs
```python
from spleeter.exceptions import (
    AudioProcessingError, 
    ModelError, 
    ValidationError
)

try:
    result = await engine.separate("audio.wav", "spleeter:2stems-16kHz")
except AudioProcessingError as e:
    print(f"√âchec traitement audio : {e}")
    print(f"Contexte erreur : {e.context}")
except ModelError as e:
    print(f"Erreur mod√®le : {e}")
except ValidationError as e:
    print(f"√âchec validation : {e}")
```

---

## üìà √âvolutivit√© & Production

### Mise √† l'√âchelle Horizontale
```python
# Configuration multi-instances
from spleeter import SpleeterCluster

cluster = SpleeterCluster(
    nodes=["worker1:8080", "worker2:8080", "worker3:8080"],
    load_balancer="round_robin",
    shared_cache="redis://cache-cluster:6379"
)

# Traitement distribu√©
result = await cluster.separate_distributed(
    audio_files=["chanson1.wav", "chanson2.wav", "chanson3.wav"],
    model_name="spleeter:4stems-16kHz"
)
```

### D√©ploiement Docker
```dockerfile
FROM tensorflow/tensorflow:2.8.0-gpu

COPY . /app/spleeter
WORKDIR /app

RUN pip install -r requirements.txt
CMD ["python", "-m", "spleeter.server"]
```

### Configuration Kubernetes
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: spleeter-service
spec:
  replicas: 3
  selector:
    matchLabels:
      app: spleeter
  template:
    metadata:
      labels:
        app: spleeter
    spec:
      containers:
      - name: spleeter
        image: spleeter:latest
        resources:
          limits:
            nvidia.com/gpu: 1
            memory: "8Gi"
          requests:
            memory: "4Gi"
```

---

## üß™ Tests & Assurance Qualit√©

### Ex√©cution Tests
```bash
# Tests unitaires
python -m pytest tests/test_core.py -v

# Tests int√©gration
python -m pytest tests/test_integration.py -v

# Tests performance
python -m pytest tests/test_performance.py --benchmark-only

# Suite tests compl√®te
python -m pytest tests/ --cov=spleeter --cov-report=html
```

### M√©triques Qualit√©
- **‚úÖ Couverture Code** : >95%
- **üéØ Performance** : <2x traitement temps r√©el
- **üõ°Ô∏è S√©curit√©** : Conformit√© OWASP
- **üìä Fiabilit√©** : Objectif uptime 99.9%

---

## ü§ù Contribution

### Configuration D√©veloppement
```bash
# Installation d√©veloppement
git clone https://github.com/spotify-ai-agent/backend.git
cd backend/spleeter

# Cr√©er environnement virtuel
python -m venv venv
source venv/bin/activate  # Sur Windows : venv\Scripts\activate

# Installer d√©pendances d√©veloppement
pip install -r requirements-dev.txt

# Installer hooks pre-commit
pre-commit install
```

### Standards Code
- **Style** : Formatage Black, conformit√© PEP 8
- **Annotations Type** : Annotations type compl√®tes
- **Documentation** : Couverture docstring >90%
- **Tests** : Couverture tests >95%

---

## üìã Journal des Modifications

### v2.0.0 (Actuel)
- ‚ú® R√©√©criture compl√®te architecture entreprise
- üöÄ Support async/await partout
- üíæ Syst√®me cache multi-niveaux
- üìä Surveillance compl√®te
- üõ°Ô∏è S√©curit√© et validation am√©lior√©es
- üéØ Am√©liorations optimisation GPU
- üì¶ Capacit√©s traitement par lots

### v1.x (H√©ritage)
- Int√©gration Spleeter basique
- Traitement synchrone uniquement
- Gestion erreurs limit√©e

---

## üìû Support & Contact

### Documentation
- **üìñ Documentation Compl√®te** : [docs.spotify-ai-agent.com](https://docs.spotify-ai-agent.com)
- **üîß R√©f√©rence API** : [api.spotify-ai-agent.com](https://api.spotify-ai-agent.com)
- **üí° Exemples** : [github.com/spotify-ai-agent/examples](https://github.com/spotify-ai-agent/examples)

### Communaut√©
- **üí¨ Discord** : [discord.gg/spotify-ai](https://discord.gg/spotify-ai)
- **üìß Email** : support@spotify-ai-agent.com
- **üêõ Issues** : [GitHub Issues](https://github.com/spotify-ai-agent/backend/issues)

### Support Entreprise
Pour les clients entreprise, support d√©di√© disponible avec garanties SLA.

---

## üìÑ Licence

Ce projet est sous licence MIT - voir le fichier [LICENSE](LICENSE) pour d√©tails.

---

## üôè Remerciements

- **√âquipe Spleeter** : Biblioth√®que Spleeter originale par Deezer Research
- **√âquipe TensorFlow** : Framework ML et optimisation GPU
- **Communaut√© Open Source** : Diverses biblioth√®ques traitement audio

---

**‚≠ê Si vous trouvez ce module utile, pensez √† √©toiler le d√©p√¥t !**

---

*Construit avec ‚ù§Ô∏è par l'√âquipe Entreprise Agent IA Spotify*  
*Architecte Principal : [Fahed Mlaiel](https://github.com/fahed-mlaiel)*
